<template>
    <div class="" style="margin-bottom:16px;">
        <div class="">
            <div class="">
                <!-- <p class="slds-p-bottom_medium slds-p-horizontal_medium ">
                    <lightning-formatted-rich-text value={showDisclosure}></lightning-formatted-rich-text>
                </p> -->

                <!-- Displays status message when an assessment is saved/ submitted --START-->
                <template if:true={showToast}>
                    <c-Show-Toast-Message message-from-component={totastmessage} is-show-modal={showToast}
                        is-sucess={success} onclosetoast={closeToastHandler}></c-Show-Toast-Message>
                </template>
                <!-- Displays status message when an assessment is saved/ submitted --END-->

                <div class="rtmvpc-card slds-p-around_x-small">
                    <!-- Displays button and picklist for navigations --START-->
                    <div class="temp_flexbox_space-between">
                        <div>
                            <template lwc:if={showButtons.Section_Navigation.show}>
                                <!-- <lightning-combobox name="Section Navigation" variant="label-hidden"
                                    value={showButtons.Section_Navigation.value}
                                    options={showButtons.Section_Navigation.options}
                                    onchange={section_navigationChangeHandler}>
                                </lightning-combobox> -->
                            </template>
                        </div>
                        <div>
                            <!-- <template lwc:if={showButtons.Summary}>
                                <lightning-button label="Summary" title="Summary" name="Summary" variant="brand"
                                    onclick={summaryClickHandler}>
                                </lightning-button>
                            </template> -->
                        </div>
                    </div>
                    <!-- Displays button and picklist for navigations --END-->

                    <div style="position:absolute; display:inline-block; right:13px; margin-top:-47px; font-weight:bold;">
                        <template if:true={isTemplate}>
                            <a class="slds-button slds-button_reset slds-accordion__summary-action" title="Expand All / Collapse All" onclick={closeAccordionSection} aria-controls="referenceId-21" aria-expanded="true">{buttonlabel}</a>
                        </template>
                    </div>
                    <div>
                        <ul class="slds-accordion">
                            <li class="slds-accordion__list-item">
                                <template if:false={isTemplate}>
                                    <template if:true={showDisclosure}>
                                        <section class={showAccordion}>
                                            <div class="slds-accordion__summary">
                                                <h2 class="slds-accordion__summary-heading">
                                                    <button class="slds-button slds-button_reset slds-accordion__summary-action" onclick={handleAccordionSection} aria-controls="referenceId-21" aria-expanded="true">
                                            <span class="slds-accordion__summary-action-icon slds-button__icon slds-button__icon_left" aria-hidden="true">
                                                <lightning-icon icon-name="utility:chevrondown" size="x-small"></lightning-icon>
                                                </span>
                                                <span class="slds-accordion__summary-content" style="width:100%">
                                                    <div style="width:100%; display:flex; justify-content:space-between">
                                                        <div>Disclosure</div>
                                                    </div>
                                                </span>
                                            </button>
                                                </h2>
                                            </div>
                                            <div class="slds-accordion__content" id="referenceId-21">{showDisclosure}
                                            </div>
                                        </section>
                                    </template>
                                </template>
                                <!-- <template if:true={isTemplate}>
                                    <button class="slds-button slds-button_reset slds-accordion__summary-action" onclick={closeAccordionSection} aria-controls="referenceId-21" aria-expanded="true">{buttonlabel}</button>
                                    </br></br></br>
                                </template> -->
                            </li>

                            <template for:each={questionsAndAnswerss} for:item="questionaryEntry">
                                <li class="slds-accordion__list-item" key={questionaryEntry.section}>
                                    <section data-accordian={questionaryEntry.sectionId} key={questionaryEntry.section}>

                                        <div class="slds-accordion__summary" key={questionaryEntry.section}>
                                            <h2 class="slds-accordion__summary-heading">
                                                <button  class="slds-button slds-button_reset slds-accordion__summary-action" data-id={questionaryEntry.sectionId} onclick={handleAccordionQuestion} aria-controls="referenceId-22" aria-expanded="true">
                                                    <span class="slds-accordion__summary-action-icon slds-button__icon slds-button__icon_left" aria-hidden="true">
                                                        <lightning-icon icon-name="utility:chevrondown" size="x-small"></lightning-icon>
                                                    </span>
                                                    <span class="slds-accordion__summary-content" style="width:100%">
                                                        <div style="width:100%; display:flex; justify-content:space-between">
                                                            <div key={questionaryEntry.section}>{questionaryEntry.section}</div>
                                                            <div class="slds-accordion__summary-contentrht" key={questionaryEntry.section}>
                                                            <template if:false={isTemplate}>
                                                                <div class="slds-grid slds-wrap slds-gutters slds-p-right_small" key={questionaryEntry.section}>
                                                                    <div class="slds-col" title="Responses" key={questionaryEntry.section}>
                                                                        <lightning-icon icon-name="utility:number_input" alternative-text="Responses" size="x-small" title="Responses"></lightning-icon>
                                                                        &nbsp;<span>:&nbsp; {questionaryEntry.numberOfResponses}/{questionaryEntry.numberOfQuestions}</span>
                                                                    </div>
                                                                    <div class="slds-col" title="% Completed" key={questionaryEntry.section}>
                                                                        <lightning-icon icon-name="utility:success" alternative-text="% Completed" size="x-small" title="% Completed"></lightning-icon>
                                                                        &nbsp;<span>:&nbsp; {questionaryEntry.responsesPercentage}%</span>
                                                                    </div>
                                                                    <div class="slds-col cib-flag" title="Additional Requests" key={questionaryEntry.section}>
                                                                        <lightning-icon icon-name="utility:priority" alternative-text="Additional Requests" size="x-small" title="Additional Requests"></lightning-icon>
                                                                        &nbsp;<span>:&nbsp; {questionaryEntry.displayFlag}</span>
                                                                    </div>
                                                                </div>
                                                            </template>
                                                            <template if:true={isTemplate}>
                                                            <template if:true={isAccountAssessment}>
                                                                <div class="slds-grid slds-wrap slds-gutters slds-p-right_small" key={questionaryEntry.section}>
                                                                    <div class="slds-col" title="Responses" key={questionaryEntry.section}>
                                                                        <lightning-icon icon-name="utility:number_input" alternative-text="Responses" size="x-small" title="Responses"></lightning-icon>
                                                                        &nbsp;<span>:&nbsp; {questionaryEntry.numberOfResponses}/{questionaryEntry.numberOfQuestions}</span>
                                                                    </div>
                                                                    <div class="slds-col" title="% Completed" key={questionaryEntry.section}>
                                                                        <lightning-icon icon-name="utility:success" alternative-text="% Completed" size="x-small" title="% Completed"></lightning-icon>
                                                                        &nbsp;<span>:&nbsp; {questionaryEntry.responsesPercentage}%</span>
                                                                    </div>
                                                                    <div class="slds-col cib-flag" title="Additional Requests" key={questionaryEntry.section}>
                                                                        <lightning-icon icon-name="utility:priority" alternative-text="Additional Requests" size="x-small" title="Additional Requests"></lightning-icon>
                                                                        &nbsp;<span>:&nbsp; {questionaryEntry.displayFlag}</span>
                                                                    </div>
                                                                </div></template>
                                                            </template>
                                                            </div>
                                                        </div>
                                                    </span>
                                                </button>
                                            </h2>
                                        </div>
                                        <div class="slds-accordion__content" key={questionaryEntry.section}
                                            id="referenceId-22">
                                            <c-rtmvpc-render-question-template responses={questionaryEntry.questions}
                                                issupplier={isSupplier} sectionid={questionaryEntry.sectionId}
                                                assessmentid ={assessment}
                                                onvaluechange={onResponseChange} onfileupload={handleFileUpload}
                                                onselectchange={handlechatHistory} ondeleteattachment={handledeletefile}
                                                onselectquestion={selectquestionHandler} recid={recordId}>
                                            </c-rtmvpc-render-question-template>
                                        </div>

                                    </section>
                                </li>
                            </template>

                        </ul>
                    </div>

                    <!-- <template if:true={isSubmitted}>
                        <div class="slds-p-around_medium slds-p-left_none slds-p-right_none"
                            style="display:flex; justify-content: space-between; align-items:center">
                        </div>
                    </template> -->
                    <!-- <div class="slds-border_top slds-m-top_small"></div> -->

                    <!-- Displays Save, Save & Submit buttons if the Assessment is not Submitted --START-->
                    <!-- <template lwc:if={showButtons.Save_Submit}>
                        <br>
                        <lightning-button variant="Brand" label="Save & Submit" title="Save Response"
                            onclick={handleSubmit} flexibility="auto" class="slds-float--right slds-button_neutral">
                        </lightning-button>
                        &nbsp;&nbsp;
                        <lightning-button variant="Brand" label="Save" title="Save Response" onclick={handleSave}
                            flexibility="auto" class="slds-float--right" style="margin-right: 5px;"></lightning-button>
                        &nbsp;&nbsp;</br>
                    </template> -->
                    <!-- Displays Save, Save & Submit buttons if the Assessment is not Submitted --END-->
                </div>
            </div>
            <template if:true={showspinner}>
                <div class="exampleHolder">
                    <lightning-spinner alternative-text="Loading" size="large"></lightning-spinner>
                </div>
            </template>
            <!-- Footer --START-->
            <!-- <div class="slds-p-horizontal_large slds-p-top_small">
                <span>SUBMITTED BY: &nbsp;&nbsp;<b>{supplierAssessmentName}</b></span><br/>
                <span>SUBMITTED DATE: &nbsp;&nbsp;<b>{supplierAssCreatedDate}</b>
                </span>
            </div> -->
            <!-- Footer --END-->
        </div>
    </div> <template if:false={isTemplate}>
        <div class="slds-p-horizontal_medium slds-p-vertical_x-small slds-border-top"
            style="position:absolute; width:100%; height:40px; bottom:0px; text-align:right; background:#e8eaed; border-top:1px solid #c9c9c9;">
            <!-- Displays Save, Save & Submit buttons if the Assessment is not Submitted --START-->
            <template lwc:if={showButtons.Save_Submit}>
                <lightning-button variant="Brand" label="Save & Submit" title="Save Response" onclick={handleSubmit}
                    flexibility="auto" class="slds-float--right slds-button_neutral">
                </lightning-button>
                &nbsp;&nbsp;
                <lightning-button variant="Brand" label="Save" title="Save Response" onclick={handleSave}
                    flexibility="auto" class="slds-float--right" style="margin-right:5px;"></lightning-button>
                &nbsp;&nbsp;
            </template>
            
            <!-- Displays Save, Save & Submit buttons if the Assessment is not Submitted --END-->
        </div>
    </template>
    <template if:true={isTemplate}>
        <template if:true={showcustomerbuttons}>
                <template if:true={showInReview}>
                    <lightning-button variant="Brand" label="Start Review" title="Save Response" onclick={handleStartReview}
                    flexibility="auto" class="slds-float--right slds-button_neutral">
                </lightning-button>
                </template>
            <template if:true={showSaveAndSubmit}>
                <lightning-button variant="Brand" label="Save & Submit" title="Save Response" onclick={handleSubmitCustomer}
                    flexibility="auto" class="slds-float--right slds-button_neutral">
                </lightning-button>
                &nbsp;&nbsp;
                <lightning-button variant="Brand" label="Save" title="Save Response" onclick={handleSaveCustomer}
                    flexibility="auto" class="slds-float--right" style="margin-right:5px;"></lightning-button>
                &nbsp;&nbsp;
            </template>
            </template>
    </template>
</template>