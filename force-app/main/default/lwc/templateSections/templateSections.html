<template>
	<div class="">
		<div class="">
			<div class="cdgWrapper">
				<template if:true={sectionList}>
					<div class="cdgtitletoolbar slds-grid slds-wrap ">
						<div class="slds-col slds-small-size_12-of-12 slds-medium-size_6-of-12 slds-large-size_6-of-12">
							<div class="slds-grid slds-wrap">
								<div class="slds-text-left">
									<lightning-icon icon-name="standard:screen" size="small" title="">
									</lightning-icon>
								</div>
								<div class="slds-text-left slds-col_bump-right slds-p-left_small">
									<h4 style="min-width:fit-content;font-weight: bold;font-size: large;">
										<p>{objLabel} ({recsCount})</p>
									</h4>
								</div>
							</div>
						</div>
						<div class="slds-col slds-small-size_12-of-12 slds-medium-size_6-of-12 slds-large-size_6-of-12">
							<div class="slds-grid slds-wrap slds-gutters_small">
								<div class="slds-col slds-text-align_right slds-size_1-of-1 ">
									<div class="slds-grid slds-wrap slds-grid_align-end slds-gutters_x-small slds-p-right_xx-small">
										<div class="slds-col"></div>
										<div class="slds-p-left_xxx-small">
											<lightning-button-icon icon-name="utility:refresh"
												style="font-size: small;color: white;" onclick={handleRefresh}
												alternative-text="Refresh" title="Refresh">
											</lightning-button-icon>
										</div>
										<template if:true={disableButtons}>
											<div class="slds-p-left_xxx-small">
												<lightning-button slds-button_neutral
													style="font-size: small;color: white;" data-name="Reorder Section"
													title="Reorder" onclick={handleGetTemplate} variant="neutral"
													type="submit" name="Section Reorder" label="Section Reorder">
												</lightning-button>
											</div>
											<div class="slds-p-left_xxx-small">
												<lightning-button slds-button_neutral
													style="font-size: small;color: white;" data-name="Reorder Question"
													title="Reorder" onclick={handleGetTemplate} variant="neutral"
													type="submit" name="Question Reorder" label="Question Reorder">
												</lightning-button>
											</div>
											<div class="slds-p-left_xxx-small slds-p-right_small">
												<lightning-button slds-button_neutral
													style="font-size: small;color: white;" data-name="New"
													title="New Record" onclick={handleGetTemplate} variant="neutral"
													type="submit" name="New" label="New">
												</lightning-button>
											</div>
											<!-- <div class="slds-p-left_xxx-small slds-p-right_small">
												<lightning-button slds-button_neutral
													style="font-size: small;color: white;" title="Delete Record"
													onclick={handleDelete} variant="neutral" type="submit" name="Delete"
													label="Delete">
												</lightning-button>
											</div> -->
										</template>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="cdg">
						<lightning-tree-grid data={sectionListData} columns={columns} key-field="Id"
							onrowaction={handleGetTemplateDetails} wrap-text-max-lines="5">
						</lightning-tree-grid>
					</div>

				</template>
			</div>
		</div>
	</div>

	<template lwc:if={showModal.createModal}>
		<div class="demo-only">
			<section role="dialog" tabindex="-1" aria-labelledby="modal-heading-02" aria-modal="true"
				aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
				<div class="slds-modal__container">
					<header class="slds-modal__header">
						<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" onclick={closeCreateModal} title="Close">
                                <lightning-icon alternative-text="close" icon-name="utility:close" size="small" variant="inverse"></lightning-icon>
                                <span class="slds-assistive-text">Close</span>
                            </button>
						<h2 id="modal-heading-04" class="slds-text-heading_medium slds-hyphenate">New Section</h2>
					</header>
					<div class="slds-modal__content slds-p-around_medium" id="modal-content-id-4">
						<div class="slds-grid slds-grid_vertical-align-end">
							<div class="slds-col">
								<c-custom-create-record-form obj-name={objectName}
									fields-list={fieldListforCreation.Rhythm__Section__c} template-id={recordId}
									onclose={closeCreateModal} onrefreshdata={handleSuccess}
									onsavenew={reOpenCreateModal}>
								</c-custom-create-record-form>
							</div>
						</div>
					</div>
				</div>
			</section>
		</div>
		<div class="slds-backdrop slds-backdrop_open"></div>
	</template>
	<template lwc:if={showModal.editModal}>
		<div class="demo-only">
			<section role="dialog" tabindex="-1" aria-labelledby="modal-heading-02" aria-modal="true"
				aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
				<div class="slds-modal__container">
					<header class="slds-modal__header">
						<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" onclick={closeEditModal} title="Close">
                                <lightning-icon alternative-text="close" icon-name="utility:close" size="small" variant="inverse"></lightning-icon>
                                <span class="slds-assistive-text">Close</span>
                            </button>
						<h2 id="modal-heading" class="slds-text-heading_medium slds-hyphenate">Edit Section</h2>
					</header>
					<div class="slds-modal__content slds-p-around_medium" id="modal-content-id">
						<div class="slds-grid slds-grid_vertical-align-end">
							<div class="slds-col">
								<c-custom-create-record-form obj-name={objectName}
									fields-list={fieldListforCreation.Rhythm__Section__c} template-id={recordId}
									onclose={closeEditModal} onrefreshdata={handleSuccess} section-name={selectedSectionName}
									section-id={selectedRecordId} onsavenew={reOpenCreateModal}>
								</c-custom-create-record-form>
							</div>
						</div>
					</div>
				</div>
			</section>
		</div>
		<div class="slds-backdrop slds-backdrop_open"></div>
	</template>

	<template lwc:elseif={showModal.deleteModal}>
		<div class="demo-only">
			<section role="dialog" tabindex="-1" aria-labelledby="modal-heading-07" aria-modal="true"
				aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
				<div class="slds-modal__container">
					<header class="slds-modal__header">
						<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" onclick={closeDeleteModal} title="Close">
                                <lightning-icon alternative-text="close" icon-name="utility:close" size="small" variant="inverse"></lightning-icon>
                                <span class="slds-assistive-text">Close</span>
                            </button>
						<h2 id="modal-heading-07" class="slds-text-heading_medium slds-hyphenate">Delete Section</h2>
					</header>
					<div class="slds-modal__content slds-p-around_medium" id="modal-content-id-7">
						<p style="text-align:center;">
							{deletePopupMessage}
						</p>
					</div>
					<footer class="slds-modal__footer">
						<lightning-button label="Cancel" variant="neutral" onclick={closeDeleteModal}>
						</lightning-button>
						&nbsp;&nbsp;&nbsp;&nbsp;
						<lightning-button label="Delete" class="whiteclr" style="color: #f9f2f2!important;"
							variant="brand" onclick={deleteRecordsHandler} disabled={disableNext}> </lightning-button>
					</footer>
				</div>
			</section>
		</div>
		<div class="slds-backdrop slds-backdrop_open"></div>
	</template>

	<!--Re-order Sections Modal Popup-->
	<template if:true={isReorderModalOpen}>
		<section role="dialog" tabindex="-1" aria-labelledby="modal-heading-02" aria-modal="true"
			aria-describedby="modal-content-id-2" class="slds-modal slds-fade-in-open">
			<div class="slds-modal__container">
				<!-- Modal/Popup Box header here -->
				<header class="slds-modal__header">
					<!-- Button to close the popup -->
					<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={closeReorderSectionModal}>
                        <lightning-icon icon-name="utility:close"
                            alternative-text="close"
                            variant="inverse"
                            size="small" ></lightning-icon>
                        <span class="slds-assistive-text">Close</span>
                    </button>
					<h2 id="modal-heading-02" class="slds-text-heading_medium slds-hyphenate">{reorderHeaderName}
					</h2>
				</header>
				<!-- Modal/Popup Box body starts here -->
				<div class="slds-modal__content slds-p-around_medium dx-duallisthide" id="modal-content-id-2">
					<!-- Displays list of selected columns and options to reorder the columns -->
					<lightning-dual-listbox id="shuffleColumns" options={reorderOptions} value={selectedReorderOptions}
						onchange={handleOrderChange}>
					</lightning-dual-listbox>
				</div>
				<!-- Modal/Popup Box footer starts here -->
				<footer class="slds-modal__footer">
					<button class="slds-button slds-button_neutral" onclick={closeReorderSectionModal} title="Cancel">Cancel</button>
					<button class="slds-button slds-button_brand" onclick={saveReorder} title="Save">Save</button>
				</footer>
			</div>
		</section>
		<div class="slds-backdrop slds-backdrop_open"></div>
	</template>
	<template if:true={viewQuestions}>
				<c-rtmvpc-question-creation onhandleaftersave={handlesave} onhandlecancel={handleCancel}
					template-id={tempid} question-id={questionId} section-name={sectionName} tempstatus={tempStatus}>
				</c-rtmvpc-question-creation>
			</template>
</template>